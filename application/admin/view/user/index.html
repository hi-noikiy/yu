{extend name="base" /}

{block name="title"}管理员管理{/block}

{block name="style"}
<style type="text/css">

</style>
{/block}


{block name="main"}
<nav class="breadcrumb"><i class="Hui-iconfont">&#xe67f;</i> <a href="/admin" class="maincolor">首页</a>
    <span class="c-gray en">&gt;</span>
    管理员管理
    <span class="c-gray en">&gt;</span>
    管理员列表
    <a class="btn btn-success radius r" style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);" title="刷新" ><i class="Hui-iconfont">&#xe68f;</i></a>
</nav>
<div class="Hui-article" style="text-align: center">
    <article class="cl pd-20">
        <div class="text-c">
            <form action="/admin/user" method="get">
                <input type="text" class="input-text" style="width:250px" placeholder="输入管理员名称" id="username" name="username" value="{$Request.param.username}">
                <button type="submit" class="btn btn-success"><i class="Hui-iconfont">&#xe665;</i> 搜用户</button>
            </form>
        </div>
        <div class="cl pd-5 bg-1 bk-gray mt-10">
            <span class="l">
                <a href="javascript:;" onclick="admin_add('添加管理员','/admin/user/create','1000','500')" class="btn btn-primary radius">
                    <i class="Hui-iconfont">&#xe600;</i> 添加管理员
                </a>
            </span>
            <span class="r">共有数据：<strong>{$list->total()}</strong> 条</span>
        </div>
        <div class="mt-10">
            <table class="table table-border table-bordered table-bg">
                <thead>
                <tr>
                    <th scope="col" colspan="9">员工列表</th>
                </tr>
                <tr class="text-c">
    <!--                <th width="25"><input type="checkbox" name="" value=""></th>-->
                    <th width="40">ID</th>
                    <th width="150">登录名</th>
                    <th width="150">真实姓名</th>
                    <th width="90">手机</th>
                    <th>角色</th>
                    <th width="130">加入时间</th>
                    <th width="100">是否已启用</th>
                    <th width="100">操作</th>
                </tr>
                </thead>
                <tbody>
                {volist name='list' id='user'}
                    <tr class="text-c">
    <!--                    <td><input type="checkbox" value="1" name=""></td>-->
                        <td>{$user.id}</td>
                        <td>{$user.username}</td>
                        <td>{$user.truename}</td>
                        <td>{$user.userphone}</td>
                        <td>{$user.group}</td>
                        <td>{$user.create_at|date='Y-m-d H:i:s'}</td>
                        {if $user.status == 1}
                        <td class="td-status"><span class="label label-success radius">已启用</span></td>
                        {else /}
                        <td class="td-status"><span class="label radius">已停用</span></td>
                        {/if}
                        <td class="td-manage">
                            {if $user.status == 1}
                                <a style="text-decoration:none" onClick="admin_stop(this,'{$user.id}')" href="javascript:;" title="停用">
                                    <i class="Hui-iconfont">&#xe631;</i>
                                </a>
                            {else /}
                                <a style="text-decoration:none" onClick="admin_start(this,'{$user.id}')" href="javascript:;" title="启用">
                                    <i class="Hui-iconfont">&#xe615;</i>
                                </a>
                            {/if}
                            <a title="编辑" href="javascript:;" onclick="admin_edit('管理员编辑','/admin/user/edit'+'?id={$user.id}','{$user.id}','1000','500')" class="ml-5" style="text-decoration:none">
                                <i class="Hui-iconfont">&#xe6df;</i>
                            </a>
    <!--                        <a title="删除" href="javascript:;" onclick="admin_del(this,'{$user.id}')" class="ml-5" style="text-decoration:none">-->
    <!--                            <i class="Hui-iconfont">&#xe6e2;</i>-->
    <!--                        </a>-->
                        </td>
                    </tr>
                {/volist}
                </tbody>
            </table>
            {$list|raw}
            {if empty($user)}
                <div id="no_content">
                <div>
                    <?xml version="1.0" encoding="UTF-8"?>
                    <svg width="122px" height="104px" viewBox="0 0 122 104" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <!-- Generator: Sketch 55 (78076) - https://sketchapp.com -->
                        <title>暂无内容</title>
                        <desc>Created with Sketch.</desc>
                        <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                            <g id="空白页" transform="translate(-656.000000, -664.000000)">
                                <g id="暂无内容" transform="translate(656.000000, 664.000000)">
                                    <g id="分组-4">
                                        <g id="背景/线" fill="#C3CBD6">
                                            <g id="-">
                                                <g id="编组" transform="translate(14.200000, 9.200000)" fill-rule="nonzero">
                                                    <path d="M0.8,73.1 C0.3581722,73.1 -5.68434189e-14,72.7418278 -5.68434189e-14,72.3 C-5.68434189e-14,71.8581722 0.3581722,71.5 0.8,71.5 L70.8,71.5 C71.2418278,71.5 71.6,71.8581722 71.6,72.3 C71.6,72.7418278 71.2418278,73.1 70.8,73.1 L0.8,73.1 Z M74.8,73.1 C74.3581722,73.1 74,72.7418278 74,72.3 C74,71.8581722 74.3581722,71.5 74.8,71.5 L77.3,71.5 C77.7418278,71.5 78.1,71.8581722 78.1,72.3 C78.1,72.7418278 77.7418278,73.1 77.3,73.1 L74.8,73.1 Z M83.8,73.1 C83.3581722,73.1 83,72.7418278 83,72.3 C83,71.8581722 83.3581722,71.5 83.8,71.5 L92.8,71.5 C93.2418278,71.5 93.6,71.8581722 93.6,72.3 C93.6,72.7418278 93.2418278,73.1 92.8,73.1 L83.8,73.1 Z M23.8,80.6 C23.3581722,80.6 23,80.2418278 23,79.8 C23,79.3581722 23.3581722,79 23.8,79 L30.8,79 C31.2418278,79 31.6,79.3581722 31.6,79.8 C31.6,80.2418278 31.2418278,80.6 30.8,80.6 L23.8,80.6 Z M35.3,80.6 C34.8581722,80.6 34.5,80.2418278 34.5,79.8 C34.5,79.3581722 34.8581722,79 35.3,79 L65.8,79 C66.2418278,79 66.6,79.3581722 66.6,79.8 C66.6,80.2418278 66.2418278,80.6 65.8,80.6 L35.3,80.6 Z M80,52.8 C80,51.7333333 81.6,51.7333333 81.6,52.8 L81.6,55.8 C81.6,56.2418278 81.2418278,56.6 80.8,56.6 L77.8,56.6 C76.7333333,56.6 76.7333333,55 77.8,55 L80,55 L80,52.8 Z M81.6,58.8 C81.6,59.8666667 80,59.8666667 80,58.8 L80,55.8 C80,55.3581722 80.3581722,55 80.8,55 L83.8,55 C84.8666667,55 84.8666667,56.6 83.8,56.6 L81.6,56.6 L81.6,58.8 Z M4,28.8 C4,27.7333333 5.6,27.7333333 5.6,28.8 L5.6,31.8 C5.6,32.2418278 5.2418278,32.6 4.8,32.6 L1.8,32.6 C0.733333333,32.6 0.733333333,31 1.8,31 L4,31 L4,28.8 Z M78.1,3.5 L80.8,3.5 C81.8666667,3.5 81.8666667,5.1 80.8,5.1 L78.1,5.1 L78.1,7.8 C78.1,8.86666667 76.5,8.86666667 76.5,7.8 L76.5,5.1 L73.8,5.1 C72.7333333,5.1 72.7333333,3.5 73.8,3.5 L76.5,3.5 L76.5,0.8 C76.5,-0.266666667 78.1,-0.266666667 78.1,0.8 L78.1,3.5 Z M5.6,34.8 C5.6,35.8666667 4,35.8666667 4,34.8 L4,31.8 C4,31.3581722 4.3581722,31 4.8,31 L7.8,31 C8.86666667,31 8.86666667,32.6 7.8,32.6 L5.6,32.6 L5.6,34.8 Z" id="Path-2"></path>
                                                    <path d="M14.0928932,61.1431458 C14.5642977,60.6717412 15.2714045,61.378848 14.8,61.8502525 L13.7393398,62.9109127 C13.5440777,63.1061748 13.2274952,63.1061748 13.032233,62.9109127 L11.9715729,61.8502525 C11.5001684,61.378848 12.2072751,60.6717412 12.6786797,61.1431458 L13.3857864,61.8502525 L14.0928932,61.1431458 Z M12.6786797,63.9715729 C12.2072751,64.4429774 11.5001684,63.7358706 11.9715729,63.2644661 L13.032233,62.2038059 C13.2274952,62.0085438 13.5440777,62.0085438 13.7393398,62.2038059 L14.8,63.2644661 C15.2714045,63.7358706 14.5642977,64.4429774 14.0928932,63.9715729 L13.3857864,63.2644661 L12.6786797,63.9715729 Z M22.9213203,8.8 C23.3927249,8.32859548 24.0998316,9.03570226 23.6284271,9.50710678 L22.567767,10.567767 C22.3725048,10.7630291 22.0559223,10.7630291 21.8606602,10.567767 L20.8,9.50710678 C20.3285955,9.03570226 21.0357023,8.32859548 21.5071068,8.8 L22.2142136,9.50710678 L22.9213203,8.8 Z M21.5071068,11.6284271 C21.0357023,12.0998316 20.3285955,11.3927249 20.8,10.9213203 L21.8606602,9.86066017 C22.0559223,9.66539803 22.3725048,9.66539803 22.567767,9.86066017 L23.6284271,10.9213203 C24.0998316,11.3927249 23.3927249,12.0998316 22.9213203,11.6284271 L22.2142136,10.9213203 L21.5071068,11.6284271 Z" id="Path复制"></path>
                                                </g>
                                            </g>
                                        </g>
                                        <g id="Group-6" transform="translate(42.000000, 31.000000)">
                                            <path d="M3,4 L35,4 C36.6568542,4 38,5.34314575 38,7 L38,40 C38,41.6568542 36.6568542,43 35,43 L3,43 C1.34314575,43 2.02906125e-16,41.6568542 0,40 L0,7 C-2.02906125e-16,5.34314575 1.34314575,4 3,4 Z" id="矩形" stroke="#C3CBD6" stroke-width="1.6" fill="#FFFFFF"></path>
                                            <path d="M15,2 C16.4174805,2 16.8954305,2.02906125e-16 18,0 L20,0 C21.1045695,-2.02906125e-16 21.7387695,2 23,2 C23.8408203,2 24.8408203,2 26,2 C27.1045695,2 28,2.8954305 28,4 L28,5 C28,6.1045695 27.1045695,7 26,7 L12,7 C10.8954305,7 10,6.1045695 10,5 L10,4 C10,2.8954305 10.8954305,2 12,2 C13.055013,2 14.055013,2 15,2 Z" id="路径" stroke="#C3CBD6" stroke-width="1.6" fill="#F5F7F9"></path>
                                            <path d="M13.4542125,13.4239785 L13.4542125,18.3586731 L13.4542125,13.4239785 Z M22.5805173,18.7015396 L18.650796,21.8070435 L22.5805173,18.7015396 Z M25.7751015,28.6475524 L20.8480956,27.5374876 L25.7751015,28.6475524 Z" id="路径-7" stroke="#C3CAD7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" transform="translate(19.000000, 22.000000) rotate(-52.000000) translate(-19.000000, -22.000000) "></path>
                                        </g>
                                    </g>
                                </g>
                            </g>
                        </g>
                    </svg>
                </div>
                暂无内容
            </div>
            {/if}
        </div>
    </article>
</div>
{/block}

{block name="script"}
<script>
    /*
        参数解释：
        title	标题
        url		请求的url
        id		需要操作的数据id
        w		弹出层宽度（缺省调默认值）
        h		弹出层高度（缺省调默认值）
    */
    /*管理员-增加*/
    function admin_add(title,url,w,h){
        layer_show(title,url,w,h);
    }
    /*管理员-删除*/
    function admin_del(obj,id){
        layer.confirm('确认要删除吗？',function(index){
            //此处请求后台程序，下方是成功后的前台处理……

            $(obj).parents("tr").remove();
            layer.msg('已删除!',{icon:1,time:1000});
        });
    }
    /*管理员-编辑*/
    function admin_edit(title,url,id,w,h){
        layer_show(title,url,w,h);
    }
    /*管理员-停用*/
    function admin_stop(obj,id){
        layer.confirm('确认要停用吗？',function(index){
            var status = 2
            //此处请求后台程序，下方是成功后的前台处理……
            $.post("{:url('/admin/user/setstatus')}",
                {'id':id,'status':status},
                function (result) {
                    if(result['code'] == 200){
                        $(obj).parents("tr").find(".td-manage").prepend('<a onClick="admin_start(this,'+id+')" href="javascript:;" title="启用" style="text-decoration:none"><i class="Hui-iconfont">&#xe615;</i></a>');
                        $(obj).parents("tr").find(".td-status").html('<span class="label radius">已停用</span>');
                        $(obj).remove();
                        layer.msg('已停用!',{icon: 5,time:1000});
                    } else {
                        layer.msg(result['msg'],{icon: 5,time:1000});
                    }
            });
        });
    }

    /*管理员-启用*/
    function admin_start(obj,id){
        layer.confirm('确认要启用吗？',function(index){
            //此处请求后台程序，下方是成功后的前台处理……
            var status = 1
            //此处请求后台程序，下方是成功后的前台处理……
            $.post("{:url('/admin/user/setstatus')}",
                {'id':id,'status':status},
                function (result) {
                    if(result['code'] == 200){
                        $(obj).parents("tr").find(".td-manage").prepend('<a onClick="admin_stop(this,'+id+')" href="javascript:;" title="停用" style="text-decoration:none"><i class="Hui-iconfont">&#xe631;</i></a>');
                        $(obj).parents("tr").find(".td-status").html('<span class="label label-success radius">已启用</span>');
                        $(obj).remove();
                        layer.msg('已启用!', {icon: 6,time:1000});
                    } else {
                        layer.msg(result['msg'],{icon: 5,time:1000});
                    }
                });

        });
    }
</script>
{/block}
