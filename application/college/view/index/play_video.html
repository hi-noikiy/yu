{extend name="web_base" /}

{block name="title"}羽化学院{/block}

{block name="style"}
<link rel="stylesheet" type="text/css" href="/static/web/college/css/play_video.css"/>
{/block}
{block name="main"}
<!--播放页-->
<div class="play_main">
    <div class="play_nav">
        <div>{$nav}</div>
    </div>
    <div class="play_content">
        <!--视频/评论-->
        <div style="width:72%; float: left;">
            <!--视频-->
            <div class="video">
                <div class="video_div_1" {if $type != 1}style="text-align: center"{/if}>{$video.name}</div>
                <div class="video_div_2" {if $type != 1}style="text-align: center"{/if}>
                    <span style="margin: 0 17px 0 0">{$video.uploader_at}</span>|
                    <span>{$video.total} 人学过</span>|
                    {if $type == 1}
                    <span>时长: {$video.video_time} min</span>|
                    {/if}
                    <span class="video_span_download">
                        {if $video.file_url != ''}
                            <a onclick="download_msg('开始下载')" href="{$video.file_url}" download="{$video.file_name}">
                        {else /}
                            <a onclick="download_msg('暂无可下载课件')" href="javascript:void(0);">
                        {/if}
                            <svg class="icon" viewBox="0 0 1024 1024" style="width: 20px;position: absolute;left: -24px;top: -2px;"><path d="M828.1 896.7H199.9c-73.2 0-132.8-59.6-132.8-132.8V514.5c0-17.7 14.3-32 32-32s32 14.3 32 32v249.4c0 37.9 30.9 68.8 68.8 68.8h628.2c37.9 0 68.8-30.9 68.8-68.8V514.5c0-17.7 14.3-32 32-32s32 14.3 32 32v249.4c0 73.2-59.6 132.8-132.8 132.8z" p-id="2220"></path><path d="M512.4 740.7c-17.7 0-32-14.3-32-32V151.8c0-17.7 14.3-32 32-32s32 14.3 32 32v556.9c0 17.7-14.3 32-32 32z" p-id="2221"></path><path d="M518.5 737.4c-8.2 0-16.4-3.1-22.6-9.4-12.5-12.5-12.5-32.8 0-45.3l156.9-156.9c12.5-12.5 32.8-12.5 45.3 0s12.5 32.8 0 45.3L541.1 728c-6.2 6.3-14.4 9.4-22.6 9.4z" p-id="2222"></path><path d="M506.2 737.2c-8.2 0-16.4-3.1-22.6-9.4L326.7 570.9c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l156.9 156.9c12.5 12.5 12.5 32.8 0 45.3-6.3 6.3-14.5 9.4-22.7 9.4z" p-id="2223"></path></svg>
                            下载课件
                        </a>
                    </span>|
                    <span class="video_span_2">
                        <svg class="icon fabulous_1" data="1" data_id="{$video.id}" onclick="fabulous(this)"  viewBox="0 0 1024 1024" style="width: 20px;position: absolute;left: -24px;top: -2px;" ><path d="M859.2 406.4H616c-1.6 0-3.2-1.6-3.2-4.8l43.2-152c8-28.8 4.8-59.2-9.6-84.8s-38.4-46.4-67.2-54.4c-28.8-8-59.2-4.8-84.8 9.6s-44.8 38.4-52.8 67.2l-22.4 78.4c-24 81.6-99.2 139.2-184 139.2h-68.8c-52.8 0-96 43.2-96 96v320c0 52.8 43.2 96 96 96h612.8c44.8 0 83.2-30.4 92.8-72l80-320c1.6-8 3.2-16 3.2-24 0-52.8-43.2-94.4-96-94.4z m-694.4 448c-17.6 0-32-14.4-32-32v-320c0-17.6 14.4-32 32-32h80v384h-80z m724.8-345.6l-80 320c-3.2 14.4-16 24-30.4 24H308.8V457.6c80-25.6 145.6-89.6 169.6-174.4l22.4-78.4C504 192 512 182.4 523.2 176c11.2-6.4 24-8 36.8-4.8 12.8 3.2 22.4 11.2 28.8 22.4 6.4 11.2 8 24 4.8 36.8L550.4 384c-1.6 6.4-3.2 12.8-3.2 19.2 0 36.8 30.4 67.2 67.2 67.2h243.2c17.6 0 32 14.4 32 32 1.6 1.6 0 4.8 0 6.4z" p-id="1190"></path></svg>
                        <svg class="icon fabulous_2" data="2" data_id="{$video.id}" onclick="fabulous(this)"  viewBox="0 0 1024 1024" style="width: 20px;position: absolute;left: -24px;top: -2px;display: none"><path d="M736.926 951H254.072c-17.736 0-32.113-14.264-32.113-32s14.377-32 32.113-32h482.855c48.351 0 100.707-24.605 127.318-59.805 17.333-22.924 22.445-47.531 15.196-73.117a32.015 32.015 0 0 1-1.063-5.618l-17.501-177.795C847.156 503.729 811.424 425 719.264 425h-123.19C578.338 425 564 410.154 564 392.419V197.441c0-46.879-16.301-70.648-48.411-70.648-27.853 0-50.791 13.652-72.095 80.15-1.801 6.503-14.987 53.428-34.972 100.863C374.903 387.601 340.987 425 301.796 425h-48.398c-17.736 0-32.113-14.765-32.113-32.5 0-17.736 14.377-32.5 32.113-32.5h47.491c2.751-1 22.013-12.493 51.312-84.453 17.838-43.81 29.4-85.866 29.515-86.287 0.119-0.435 0.247-0.83 0.384-1.261 12.209-38.306 26.135-65.426 43.826-85.39 23.558-26.582 53.718-40.052 89.643-40.052 37.388 0 67.668 15.144 87.74 43.786C619.523 129.481 628 160.985 628 197.441V360h91.264c54.56 0 102.305 20.056 138.071 57.71 32.346 34.055 54.83 81.732 66.824 141.555 0.21 1.048 0.368 2.145 0.474 3.21l17.397 176.994c11.456 43.766 2.079 88.464-26.554 126.337C876.312 917.61 806.226 951 736.926 951z" fill="#E75934" p-id="1320"></path><path d="M240 951.183c-17.736 0-32-14.377-32-32.113V392.419c0-17.736 14.264-32.113 32-32.113s32 14.377 32 32.113V919.07c0 17.736-14.264 32.113-32 32.113z" fill="#E75934" p-id="1321"></path><path d="M318 828.5c0 70.416-57.084 127.5-127.5 127.5S63 898.916 63 828.5v-339C63 419.084 120.084 362 190.5 362S318 419.084 318 489.5v339z" fill="#E75934" p-id="1322"></path></svg>
                        <span class="fabulous_num" style="margin: 0">{$video.fabulous}</span> 人点赞
                    </span>|
                </div>
                {if $type == 1}
                    <video id="video" style="width: 100%;" controls="controls" controlsList="nodownload" src="" poster="{$video.video_img}">
                        浏览器暂不支持播放视频,请更换浏览器
                    </video>
                {elseif $type == 2 /}
                    <div>
                        {$video.course_text|raw}
                    </div>
                {else /}
                    <div>
                        <p style="font-size: 20px;text-align: center">此课件只支持下载查看</p><br>
                        <p style="font-size: 15px;">点击下载 : <a style="color: #ff0707" onclick="download_msg('开始下载')" href="{$video.file_url}" download="{$video.file_name}">{$video.file_name}</a></p>
                    </div>
                {/if}
            </div>
            <!--评论-->
<!--            <div class="evaluate">-->
<!--                <div class="evaluate_div_1">课程介绍</div>-->
<!--                <div class="evaluate_div_2">课程评价</div>-->
<!--                <div style="border: #e2e2e2 1px solid"></div>-->
<!--            </div>-->
        </div>
        <!--喜欢-->
        <div class="like">
            <div class="like_div_1">猜你喜欢</div>
            <div class="like_div_2">
                {volist name='like_video' id='like_video'}
                {if empty($like_video.video_img)}
                    {assign name="$like_video.video_img" value="/static/web/college/images/fm_img.png" /}
                {/if}
                {if $like_video.type == 1}
                    {assign name="class_name" value="ico_play" /}
                {else /}
                    {assign name="$like_video.video_time" value="0" /}
                    {assign name="class_name" value="ico_read" /}
                {/if}
                <div class='main like_main'>
                    <a href='/college/read?id={$like_video.id}'>
                        <div class='img_class like_img' style='background-image: url("{$like_video.video_img}");background-size: cover;-o-background-size: cover;background-position: center 0;'>
                            <div class='play {$class_name}'></div>
                        </div>
                    </a>
                    <div class='like_div_3'>{$like_video.name}</div>
                    <div class="like_div_4">
                        <span style='float: left'>{$like_video.total} 人学过</span>
                        <span style='float: right'>{$like_video.video_time} min</span>
                    </div>
                </div>
                {/volist}
            </div>
        </div>
        <div style="clear: both"></div>
    </div>
</div>
{/block}
{block name="script"}
<script src="/static/js/hls.js"></script>
<script>
    if({$is_fabulous} == 1){
        $(".fabulous_1").hide()
        $(".fabulous_2").show()
    } else {
        $(".fabulous_1").show()
        $(".fabulous_2").hide()
    }
    // 点赞1点赞 2取消
    function fabulous(self) {
        var status = '';
        var fabulous_num = $(".fabulous_num").html();
        var type = 1; // 类型 1 为视频表 2 预留文本表
        if(self.getAttribute("data") == 1){
            status = 1 // 点赞
            fabulous_num = Number(fabulous_num)+1;
            $(".fabulous_1").hide()
            $(".fabulous_2").show()
        } else {
            status = 0 // 取消点赞
            fabulous_num = Number(fabulous_num)-1;
            $(".fabulous_1").show()
            $(".fabulous_2").hide()
        }
        var video_id = self.getAttribute("data_id");
        $.post("/college/setfabulous",{"id":video_id,'status':status,'type':type},function (result) {
            if(result['code'] == 200){
                $(".fabulous_num").html(fabulous_num);
            }
        })
    }
    function download_msg(msg){
        layer.msg(msg)
    }
</script>
<script>
    if (Hls.isSupported()) {
        var video2 = document.getElementById('video');
        var hls = new Hls();
        hls.loadSource("{$video.url}");
        hls.attachMedia(video2);
        hls.on(Hls.Events.MANIFEST_PARSED, function () {
            video2.play();
        });
    }
</script>
{/block}
